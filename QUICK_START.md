# Deposit & Withdrawal Feature - Quick Start Guide

## For Users

### Making a Deposit
```
Dashboard â†’ Sidebar "Deposit & Withdraw"
            â†“
         Click "ğŸ’³ Deposit"
            â†“
    Upload Payment Screenshot
    + Enter Amount (min 100 PKR)
            â†“
       Click "Submit Deposit"
            â†“
   Red Message: "Wait 5 minutes..."
            â†“
    Admin reviews and approves
            â†“
   âœ“ Success notification appears
```

### Making a Withdrawal
```
Dashboard â†’ Sidebar "Deposit & Withdraw"
            â†“
      Click "ğŸ¦ Withdrawal"
            â†“
    Upload Withdrawal Proof
    + Enter Amount (min 100 PKR)
            â†“
    Click "Submit Request"
            â†“
   Red Message: "Wait 5 minutes..."
            â†“
    Admin reviews and approves
            â†“
   âœ“ Funds processed notification
```

### Viewing Transaction History
```
Dashboard â†’ "Deposit & Withdraw"
            â†“
      Scroll to "Transaction History"
            â†“
    View all transactions with:
    - Status badge (pending/approved/rejected)
    - Amount and type
    - Date
    - Screenshot preview
    - Rejection reason (if rejected)
```

---

## For Admins

### Approving Transactions
```
Dashboard â†’ Admin Nav â†’ "ğŸ’° Transactions"
            â†“
    See all pending requests
            â†“
    Review user info & screenshot
            â†“
       Click "âœ“ Approve"
            â†“
   âœ“ Transaction approved
      User notified automatically
```

### Rejecting Transactions
```
Dashboard â†’ Admin Nav â†’ "ğŸ’° Transactions"
            â†“
    See all pending requests
            â†“
    Review user info & screenshot
            â†“
       Click "âœ— Reject"
            â†“
    Enter reason (e.g., "Wrong account")
            â†“
   âœ— Transaction rejected
      User sees reason in history
```

---

## Screenshots/UI Elements

### User Modal - Deposit Form
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ•  ğŸ’³ Deposit Funds                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Payment Screenshot *                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Click to upload proof image   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  [Choose Screenshot]                 â”‚
â”‚                                       â”‚
â”‚  Amount (PKR) *                       â”‚
â”‚  [____________100_____________]       â”‚
â”‚                                       â”‚
â”‚      [Cancel]    [Submit Deposit]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Admin Transaction Card
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  John Doe                    [PENDING]      â”‚
â”‚  john@example.com â€¢ 03001234567            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Transaction Type: ğŸ’³ Deposit              â”‚
â”‚  Amount: PKR 5000                          â”‚
â”‚                                            â”‚
â”‚  [Screenshot Preview Image]                â”‚
â”‚                                            â”‚
â”‚  [âœ“ Approve]  [âœ— Reject]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Transaction History Item
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’³ Deposit          [APPROVED]             â”‚
â”‚                                            â”‚
â”‚  PKR 5000                                  â”‚
â”‚  Dec 10, 2024                              â”‚
â”‚                                            â”‚
â”‚  [Payment Proof Screenshot]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Quick Reference

### Submit Transaction (User)
```bash
curl -X POST http://localhost:3000/api/transactions \
  -H "Content-Type: application/json" \
  -d '{
    "type": "deposit",
    "amount": 5000,
    "screenshot": "data:image/png;base64,iVBORw0KGgo..."
  }'
```

### Get Admin Transactions
```bash
curl http://localhost:3000/api/admin/transactions?status=pending
```

### Approve Transaction
```bash
curl -X PATCH http://localhost:3000/api/admin/transactions/[ID] \
  -H "Content-Type: application/json" \
  -d '{"status": "approved"}'
```

### Reject Transaction
```bash
curl -X PATCH http://localhost:3000/api/admin/transactions/[ID] \
  -H "Content-Type: application/json" \
  -d '{"status": "rejected", "comment": "Invalid account number"}'
```

---

## Key Settings (Customizable)

In `dashboard.html` JavaScript:

```javascript
// Minimum amount (PKR)
if (amount < 100) { // Change 100 to desired minimum
  alert('Minimum deposit amount is 100 PKR');
}

// Waiting time before dismissing modal (milliseconds)
setTimeout(() => {
  closeModal('depositModal');
  loadTransactions();
}, 5000);  // Change 5000 to different duration
```

---

## Status Colors
- ğŸŸ  **Pending** (Orange): Waiting for admin review
- ğŸŸ¢ **Approved** (Green): Successfully processed
- ğŸ”´ **Rejected** (Red): Not approved, see reason

---

## Error Handling
- Amount validation: "Minimum amount is 100 PKR"
- Missing fields: "Please provide both screenshot and amount"
- Upload errors: "Error submitting deposit"
- Network errors: "Error loading transactions"

---

## Features Included
âœ… User-friendly modals with image preview
âœ… Real-time screenshot upload and preview
âœ… Base64 image encoding for database storage
âœ… Admin approval/rejection workflow
âœ… Transaction history with status tracking
âœ… Rejection reasons display
âœ… Responsive mobile design
âœ… Smooth animations and transitions
âœ… Comprehensive error handling
âœ… Professional UI with color-coded statuses

---

## Notes
- Screenshots are stored as base64 strings (max ~5MB)
- For production, consider using Cloudinary or AWS S3
- All operations require user authentication
- Admin operations require admin role
- Minimum amount can be configured in code
- Waiting period is 5 seconds (see line in code comments)
